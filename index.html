// DOM Elements
const editor = document.getElementById('editor');
const fileInput = document.getElementById('fileInput');
const saveBtn = document.getElementById('saveBtn');
const downloadBtn = document.getElementById('downloadBtn');
const status = document.getElementById('status');

// --- FILE IMPORT / UPLOAD ---
fileInput.addEventListener('change', (event) => {
  const file = event.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = e => {
    editor.value = e.target.result; // textarea uses .value
    status.textContent = `Loaded: ${file.name}`;
  };
  reader.readAsText(file);
});

// --- SAVE CURRENT TEXT LOCALLY ---
saveBtn.addEventListener('click', () => {
  // Here you could also integrate saving to an in-browser workspace.
  // For now, mark status as saved:
  status.textContent = 'Changes saved to workspace (in-memory).';
});

// --- DOWNLOAD CURRENT TEXT AS FILE ---
downloadBtn.addEventListener('click', () => {
  const text = editor.value;
  const blob = new Blob([text], { type: 'text/plain' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'playbook.txt'; // Or dynamic name if needed
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
  status.textContent = 'Downloaded current file.';
});
